{
"comment": "!! PLEASE DO NOT EDIT THIS FILE - THIS FILE IS AUTO-GENERATED !!",
"policies": [
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_cloudtrail[*].*[*].kms_key_id anyNull or $.resource[*].aws_cloudtrail[*].*[*].kms_key_id anyEmpty",
    "id": "07a06f60-1532-4e2e-b91c-8f972a96f1a9",
    "enabled": true,
    "resourceType": "cloudtrail",
    "policy": "AWS CloudTrail logs are not encrypted using Customer Master Keys"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_kms_key[*].*[?(@.enable_key_rotation != 'true')] exists",
    "id": "497f7e2c-b702-47c7-9a07-f0f6404ac896",
    "enabled": true,
    "resourceType": "kms",
    "policy": "AWS Customer Master Key (CMK) rotation is not enabled"
  },
  {
    "severity": "high",
    "rule": "$.resource[*].aws_default_security_group exists and ($.resource[*].aws_default_security_group.*[*].*.ingress[*].cidr_blocks[*] contains 0.0.0.0/0 or $.resource[*].aws_default_security_group.*[*].*.ingress[*].ipv6_cidr_blocks[*] contains ::/0 or $.resource[*].aws _default_security_group.*[*].*.egress[*].cidr_blocks[*] contains 0.0.0.0/0 or $.resource[*].aws_default_security_group.*[*].*.egress[*].ipv6_cidr_blocks[*] contains ::/0)",
    "id": "c8f6a525-e4ba-4499-b015-15153c797143",
    "enabled": true,
    "resourceType": "security group",
    "policy": "AWS Default Security Group does not restrict all traffic"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_security_group.*[*].*.ingress[?(@.protocol == 'tcp' && @.from_port == '22' && @.to_port == '22')].cidr_blocks[*] == 0.0.0.0/0 or $.resource[*].aws_security_group.*[*].*.ingress[?(@.protocol == 'tcp' && @.from_port == '22' && @.to_port == '22')].ipv6_cidr_blocks[*] == ::/0",
    "id": "c2bcdbe7-7c2c-48bc-a0f7-37e1b9766385",
    "enabled": true,
    "resourceType": "Security Group ingress rule",
    "policy": "AWS EC2 instance have SSH port open to internet"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_elasticsearch_domain exists and $.resource[*].aws_elasticsearch_domain[*].es[*].vpc_options does not exist",
    "id": "28ee2708-305a-4b23-acf0-535ab45b96ab",
    "enabled": true,
    "resourceType": "elasticsearch",
    "policy": "AWS ElasticSearch cluster not in a VPC"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_iam_account_password_policy[*].*[*].max_password_age greater than 90",
    "id": "cb4e7ef6-b4b4-45a5-9ae5-194d3a0e12e9",
    "enabled": true,
    "resourceType": "iam_account_password",
    "policy": "AWS IAM password policy does not expire in 90 days"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_iam_account_password_policy[*].*[*].minimum_password_length less than 14",
    "id": "7228106b-f82f-4d2e-a1a0-73fd15f70637",
    "enabled": true,
    "resourceType": "iam_account_password",
    "policy": "AWS IAM password policy does not have a minimum of 14 characters"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_iam_account_password_policy[*].*[*].require_lowercase_characters is false",
    "id": "77c2d5a8-071f-48b9-9de0-5917e9b4548d",
    "enabled": false,
    "resourceType": "iam_account_password",
    "policy": "AWS IAM password policy does not have a lowercase character"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_iam_account_password_policy[*].*[*].require_numbers is false",
    "id": "41fdae49-6fc7-4bc9-80e4-2cbb2262ab7a",
    "enabled": false,
    "resourceType": "iam_account_password",
    "policy": "AWS IAM password policy does not have a number"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_iam_account_password_policy[*].*[*].require_symbols is false",
    "id": "f8013bbf-21b8-4e81-b6ef-7b568407129c ",
    "enabled": false,
    "resourceType": "iam_account_password",
    "policy": "AWS IAM password policy does not have a symbol"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_iam_account_password_policy[*].*[*].require_uppercase_characters is false",
    "id": "d6dadfcf-a98c-4917-97b5-a5df6a9c493d ",
    "enabled": false,
    "resourceType": "iam_account_password",
    "policy": "AWS IAM password policy does not have a uppercase character"
  },
  {
    "severity": "high",
    "rule": "$.resource[*].aws_eks_cluster[*].*[*].version starts with 1.9",
    "id": "60440266-3d03-41ce-ba8c-d51ccbdb6804",
    "enabled": true,
    "resourceType": "eks",
    "policy": "AWS Kubernetes unsupported master node version"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_redshift_cluster exists and ($.resource[*].aws_redshift_parameter_group[*].*[*].parameter[?(@.name=='require_ssl')] !exists or $.resource[*].aws_redshift_parameter_group[*].*[*].parameter[?(@.name=='require_ssl')].value isFalse)",
    "id": "2ff03f80-c9f6-4a37-b8b1-1212965e352d",
    "enabled": true,
    "resourceType": "redshift",
    "policy": "AWS Redshift does not have require_ssl configured"
  },
  {
    "severity": "high",
    "rule": "$.resource[*].aws_s3_bucket exists and ($.resource[*].aws_s3_bucket.*[*].*.acl does not exist or ($.resource[*].aws_s3_bucket.*[*].*.acl equals public-read-write or $.resource[*].aws_s3_bucket.*[*].*.acl equals public-read))",
    "id": "ded75b65-7ef6-4239-a08f-d4d9a4eb218b",
    "enabled": true,
    "resourceType": "s3",
    "policy": "AWS S3 buckets are accessible to public"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].aws_s3_bucket exists and ($.resource[*].aws_s3_bucket.*[*].*.versioning does not exist or ($.resource[*].aws_s3_bucket.*[*].*.versioning exists and $.resource[*].aws_s3_bucket.*[*].*.versioning[*].enabled any equal false))",
    "id": "1914c65c-2406-4261-88cd-fbeb684a15dc",
    "enabled": true,
    "resourceType": "s3",
    "policy": "AWS S3 object versioning is disabled"
  },
  {
    "severity": "high",
    "rule": "$.resource[*].aws_security_group[*].[*].[*].ingress[*].to_port == 3389",
    "id": "1796efe6-802d-4768-8c17-7491c560b686",
    "enabled": true,
    "resourceType": "security group",
    "policy": "AWS Security Groups allow internet traffic from internet to RDP port (3389)"
  },
  {
    "severity": "high",
    "rule": "$.resource[*].aws_security_group exists and ($.resource[*].aws_security_group.*[*].*.ingress[?(@.protocol == 'tcp' && @.from_port == '22' && @.to_port == '22')].cidr_blocks[*] contains 0.0.0.0/0 or $.resource[*].aws_security_group.*[*].*.ingress[?(@.protocol == 'tcp' && @.from_port == '22' && @.to_port == '22')].ipv6_cidr_blocks[*] contains ::/0)",
    "id": "9745cb18-32f9-4411-a59c-fae4ffa362ce",
    "enabled": true,
    "resourceType": "security group",
    "policy": "AWS Security Groups allow internet traffic to SSH port (22)"
  },
  {
    "severity": "high",
    "rule": "($.resource[*].aws_security_group exists and ($.resource[*].aws_security_group.*[*].*.ingress[*].protocol equals -1 and ($.resource[*].aws_security_group.*[*].*.ingress[*].cidr_blocks[*] contains 0.0.0.0/0 or $.resource[*].aws_security_group.*[*].*.ingress[*].ipv6_cidr_blocks[*] contains ::/0))) or ($.resource[*].aws_security_group_rule exists and ($.resource[*].aws_security_group_rule.*[*].*.protocol equals -1 and $.resource[*].aws_security_group_rule.*[*].*.type equals ingress and ($.resource[*].aws_security_group_rule.*[*].*.cidr_blocks[*] contains 0.0.0.0/0 or $.resource[*].aws_security_group_rule.*[*].*.ipv6_cidr_blocks[*] contains ::/0)))",
    "id": "eba4d571-4338-4f62-8110-9be6c4b47fd0",
    "enabled": true,
    "resourceType": "security group",
    "policy": "AWS Security Groups with Inbound rule overly permissive to All Traffic"
  },
  {
    "severity": "high",
    "rule": "($.resource[*].azurerm_network_security_rule exists and ($.resource[*].azurerm_network_security_rule.*[*].*.access contains Allow and $.resource[*].azurerm_network_security_rule.*[*].*.destination_address_prefix contains * and $.resource[*].azurerm_network_security_rule.*[*].*.source_address_prefix contains * and $.resource[*].azurerm_network_security_rule.*[*].*.destination_port_range contains 22 and $.resource[*].azurerm_network_security_rule.*[*].*.direction contains Inbound))",
    "id": "1eb0cd02-789a-4b96-8463-fb5583e40585",
    "enabled": true,
    "resourceType": "nsg",
    "policy": "Azure Network Security Group (NSG) allows SSH traffic from internet on port 22"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].google_storage_bucket exists and ($.resource[*].google_storage_bucket.*[*].*.versioning does not exist or $.resource[*].google_storage_bucket.*[*].*.versioning exists and ($.resource[*].google_storage_bucket.*[*].*.versioning[*].enabled any equal false))",
    "id": "53a9b6e1-dd93-4110-b443-4658c13134b4",
    "enabled": true,
    "resourceType": "storage",
    "policy": "GCP Storage log buckets have object versioning disabled"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].azurerm_storage_account exists and ($.resource[*].azurerm_storage_account.*[*].*.enable_https_traffic_only does not exist or ($.resource[*].azurerm_storage_account.*[*].*.enable_https_traffic_only exists and $.resource[*].azurerm_storage_account.*[*].*.enable_https_traffic_only any equal false))",
    "id": "80f6dc01-4aaa-4712-a7bf-70e103fea4a3",
    "enabled": true,
    "resourceType": "storage",
    "policy": "Storage Accounts without Secure transfer enabled"
  },
  {
    "severity": "medium",
    "rule": "$.resource[*].google_storage_bucket exists and ($.resource[*].google_storage_bucket.*[*].*.logging does not exist or $.resource[*].google_storage_bucket.*[*].*.logging[*].log_bucket is empty)",
    "id": "22df2129-f6bf-4a10-9118-42b8d5d922a9",
    "enabled": true,
    "resourceType": "storage",
    "policy": "Storage Bucket does not have Access and Storage Logging enabled"
  }
]
}