{
  "severity": "low",
  "resourceType": "IAM",
  "policy": "GCP IAM user have overly permissive Cloud KMS roles",
  "description": "This policy identifies IAM users who have overly permissive Cloud KMS roles. Built-in/Predefined IAM role Cloud KMS Admin allows the user to create, delete, and manage service accounts. Built-in/Predefined IAM role Cloud KMS CryptoKey Encrypter/Decrypter allows the user to encrypt and decrypt data at rest using the encryption keys. It is recommended to follow the principle of 'Separation of Duties' ensuring that one individual does not have all the necessary permissions to be able to complete a malicious action.",
  "rule": "$.data[*].google_iam_policy[*].*[*].binding[?( @.role=='roles/cloudkms.admin' )].member startsWith \"user:\"  or $.data[*].google_iam_policy[*].*[*].binding[?( @.role=='roles/cloudkms.admin' )].members any start with \"user:\" or  $.resource[*].google_organization_iam_binding[*].binding[?( @.role=='roles/cloudkms.admin' )].member startsWith \"user:\" or $.resource[*].google_organization_iam_binding[*].binding[?( @.role=='roles/cloudkms.admin' )].members any start with \"user:\" or $.resource[*].google_organization_iam_member[*].binding[?( @.role=='roles/cloudkms.admin' )].member startsWith \"user:\" or $.resource[*].google_organization_iam_member[*].binding[?( @.role=='roles/cloudkms.admin' )].members any start with \"user:\"  or $.resource[*].google_project_iam_binding[*].*[?( @.role=='roles/cloudkms.admin')].member startsWith \"user:\"  or $.resource[*].google_project_iam_binding[*].*[?( @.role=='roles/cloudkms.admin')].members any start with \"user:\"  or $.resource[*].google_project_iam_member[*].*[?( @.role=='roles/cloudkms.admin' )].member startsWith \"user:\" or $.resource[*].google_project_iam_member[*].*[?( @.role=='roles/cloudkms.admin' )].members any start with \"user:\"",
  "id": "54839df2-74d6-4642-a12f-807638f89842",
  "enabled": true,
  "recommendation": {
    "name": "Recommended solution to ensure that GCP IAM User doesn't have overly permissive Cloud KMS roles.",
    "description": "Ensure that GCP IAM User doesn't have overly permissive Cloud KMS roles. Please make sure that in the template \"members\" doesn't start with \"user:\" when the \"role\" is \"roles/cloudkms.admin\"",
    "snippet": "\"google_iam_policy\": [\n        {\n          \"x\": [\n            {\n              \"binding\": [\n                {\n                  \"members\":  [\"admin:c@d.com\"],\n                  \"role\": \"roles/cloudkms.admin\"\n                }\n              ]\n            }\n          ]\n        }"
  }
}