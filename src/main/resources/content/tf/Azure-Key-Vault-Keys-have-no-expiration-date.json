{
  "severity": "medium",
  "rule": "$.resource.*.azurerm_key_vault_secret[*].*[*].expiration_date anyNull",
  "id": "b8905f18-5d8a-4d4a-aded-e139a3432fa7",
  "enabled": true,
  "resourceType": "Azure Key Vault Key",
  "policy": "Azure Key Vault Keys have no expiration date",
  "description": "This policy identifies Azure Key Vault keys that do not have an expiration date. As a best practice, set an expiration date for each key and rotate your keys regularly.\n\nBefore you activate this policy, ensure that you have added the Redlock Service Principal to each Key Vault: https://docs.paloaltonetworks.com/redlock/redlock-admin/connect-your-cloud-platform-to-redlock/onboard-your-azure-account/set-up-your-azure-account.html\n\nAlternatively, run the following command on the Azure cloud shell:\naz keyvault list | jq '.[].name' | xargs -I {} az keyvault set-policy --name {} --certificate-permissions list listissuers --key-permissions list --secret-permissions list --spn <redlock_app_id>"
}